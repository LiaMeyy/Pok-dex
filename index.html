<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarjeta Pokémon</title>
    <link rel="stylesheet" href="./styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="search">
        <input id="pok" type="text">
        <button onclick="traer()">Buscar</button>
    </div>

    <div class="Content">
        <button>-></button>
        <div class="cart">
            <div class="header">
                <h1 id="nombre"></h1>
                <h3 id="numero"></h3>
            </div>

            <div class="imagen" id="img-bg">
                <img id="img" alt="">
            </div>
            <div class="cts">
                <h3 id="altura"></h3>
                <div id="typeIcon"></div>

                <h3 id="Peso"></h3>
            </div>

            <div class="types">
                <div class="barrera"></div>
                <h3>TYPE</h3>
                <div id="Tipo"></div>
                <div class="barrera"></div>
                <h3>WEAKNESSES</h3>
                <div id="Debilidades"></div>
            </div>
        </div>
    </div>

    <div class="back">
            <h2 id="nombreBack"></h2>
            <p id="descripcion"></p>
            <p id="habilidades"></p>
        </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>

        async function traer() {
            let pokemon = document.getElementById("pok").value;
            let res = await axios.get(`https://pokeapi.co/api/v2/pokemon/${pokemon}`);
            //header
            document.getElementById("nombre").textContent = res.data.name.toUpperCase();
            document.getElementById("numero").textContent = `#${res.data.id}`;
            document.getElementById("img").src = res.data.sprites.other["official-artwork"]["front_default"];
            //caracteristicas
            document.getElementById("altura").textContent = `HEIGHT : ${res.data.height / 10} m`;
            const tipoPrincipal = res.data.types[0].type.name;
            document.getElementById("typeIcon").innerHTML = getTypeIcon(tipoPrincipal);
            document.getElementById("Peso").textContent = `WEIGHT: ${res.data.weight / 10} kg`;
            //tipo y color según su tipo
            const tipoDiv = document.getElementById("Tipo");
            tipoDiv.innerHTML = "";
            res.data.types.forEach(t => {
                tipoDiv.appendChild(crearBadge(t.type.name));
            });
            // color de debilidades
            const tiposCrudos = res.data.types.map(t => t.type.name);
            setImageBackground(tiposCrudos)
            const deb = await debilidades(res.data.name);
            const debDiv = document.getElementById("Debilidades");
            debDiv.innerHTML = "";
            deb.forEach(w => {
                debDiv.appendChild(crearBadge(w));
            });
        }
        //funcion debilidades
        async function debilidades(nameP) {
            let res = await axios.get(`https://pokeapi.co/api/v2/pokemon/${nameP}`);
            const pokData = res.data;

            const typeUrls = pokData.types.map(t => t.type.url);
            const Debilidades = new Set();

            for (const url of typeUrls) {
                const typeres = await axios.get(url);
                const typeData = typeres.data;

                typeData.damage_relations.double_damage_from.forEach(t => {
                    Debilidades.add(t.name);
                });
            }

            return [...Debilidades];
        }

        function crearBadge(tipo) {
            const span = document.createElement("span");
            span.textContent = tipo.toUpperCase();
            span.classList.add("badge", tipo.toLowerCase());
            return span;
        }

        function setImageBackground(types) {
            const imgBg = document.getElementById("img-bg");

            const typeColors = {
                fire: "#F08030",
                water: "#6890F0",
                grass: "#78C850",
                electric: "#F8D030",
                ice: "#98D8D8",
                fighting: "#C03028",
                poison: "#A040A0",
                ground: "#E0C068",
                flying: "#A890F0",
                psychic: "#F85888",
                bug: "#A8B820",
                rock: "#B8A038",
                ghost: "#705898",
                dark: "#705848",
                dragon: "#7038F8",
                steel: "#B8B8D0",
                fairy: "#EE99AC",
                normal: "#f7f7ff"
            };

            if (types.length === 1) {
                imgBg.style.background = typeColors[types[0]];
            } else {
                imgBg.style.background = `linear-gradient(135deg, ${typeColors[types[0]]}, ${typeColors[types[1]]})`;
            }
        }
        function getTypeIcon(tipo) {
            const icons = {
                normal: `
<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#A8A77A" viewBox="0 0 24 24">
  <path d="M4 8a8 8 0 1 1 16 0a8 8 0 1 1-16 0zm4 0a4 4 0 1 0 8 0a4 4 0 1 0-8 0z"/>
</svg>
        `,
                fire: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#EE8130" viewBox="0 0 24 24">
  <path d="M12 2c3 4 5 6 5 9a5 5 0 1 1-10 0c0-3 2-5 5-9z"/>
</svg>
`,
                water: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#6390F0" viewBox="0 0 24 24">
  <path d="M12 3c4 5 6 8 6 11a6 6 0 1 1-12 0c0-3 2-6 6-11z"/>
</svg>
`,
                grass: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#7AC74C" viewBox="0 0 24 24">
  <path d="M12 2c-4 2-7 6-7 10a7 7 0 0 0 14 0c0-4-3-8-7-10zm0 4c2 2 3 4 3 6a3 3 0 1 1-6 0c0-2 1-4 3-6z"/>
</svg>
`,
                electric: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#F7D02C" viewBox="0 0 24 24">
  <path d="M10 2l-2 8h4l-2 10l8-12h-4l2-6h-6z"/>
</svg>
`,
                ice: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#96D9D6" viewBox="0 0 24 24">
  <path d="M12 2l3 5l5 3l-5 3l-3 5l-3-5l-5-3l5-3l3-5z"/>
</svg>
`,
                fighting: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#C22E28" viewBox="0 0 24 24">
  <path d="M6 4h12v6l-6 10l-6-10v-6z"/>
</svg>
`,
                poison: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#A33EA1" viewBox="0 0 24 24">
  <path d="M12 3a6 6 0 1 1 0 12a6 6 0 1 1 0-12zm-3 13c-2 1-3 2-3 3h12c0-1-1-2-3-3H9z"/>
</svg>
`,
                ground: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#E2BF65" viewBox="0 0 24 24">
  <path d="M3 12h18l-2 8h-14l-2-8zm3-6h12l1 4h-14l1-4z"/>
</svg>
`,
                flying: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#A98FF3" viewBox="0 0 24 24">
  <path d="M3 6c5 1 8 3 9 6c1-3 4-5 9-6c-3 5-6 10-9 12c-3-2-6-7-9-12z"/>
</svg>
`,
                psychic: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#F95587" viewBox="0 0 24 24">
  <path d="M12 4a8 8 0 1 1 0 16a8 8 0 1 1 0-16zm0 4a4 4 0 1 0 0 8a4 4 0 1 0 0-8z"/>
</svg>
`,
                bug: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#A6B91A" viewBox="0 0 24 24">
  <path d="M12 2l3 4h4l-3 4l3 4h-4l-3 4l-3-4h-4l3-4l-3-4h4l3-4z"/>
</svg>
`,
                rock: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#B6A136" viewBox="0 0 24 24">
  <path d="M6 4l12 2l2 6l-5 8h-8l-5-8l2-6l12-2z"/>
</svg>
`,
                ghost: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#735797" viewBox="0 0 24 24">
  <path d="M6 10a6 6 0 1 1 12 0v8l-2-1l-2 1l-2-1l-2 1l-2-1v-8z"/>
</svg>
`,
                dragon: `
<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#6F35FC" viewBox="0 0 24 24">
  <path d="M4 4c5-2 10 0 12 4c2 4 1 8-2 10c-4 3-10 0-12-4c-2-4-1-8 2-10zm8 3l-3 3l3 3l3-3l-3-3z"/>
</svg>
`,

                dark: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#705746" viewBox="0 0 24 24">
  <path d="M12 3a9 9 0 1 1 0 18c5-3 5-15 0-18z"/>
</svg>
`,
                steel: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#B7B7CE" viewBox="0 0 24 24">
  <path d="M12 2l3 2l3 5l-3 5l-3 2l-3-2l-3-5l3-5l3-2z"/>
</svg>
`,
                fairy: `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="#D685AD" viewBox="0 0 24 24">
  <path d="M12 3l2 4l4 2l-4 2l-2 4l-2-4l-4-2l4-2l2-4z"/>
</svg>
`,
            };

            return icons[tipo] || "";
        }


    </script>
</body>

</html>